---
// Google Analytics 5 (GA4) - Anonymous tracking
const GA_MEASUREMENT_ID = import.meta.env.PUBLIC_GA_MEASUREMENT_ID || 'G-XXXXXXXXXX';
---

<!-- Google Analytics 5 (GA4) -->
{GA_MEASUREMENT_ID && (
  <>
    <script async src={`https://www.googletagmanager.com/gtag/js?id=${GA_MEASUREMENT_ID}`}></script>
    <script is:inline define:vars={{ GA_MEASUREMENT_ID }}>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      // Privacy-first configuration
      gtag('config', GA_MEASUREMENT_ID, {
        'anonymize_ip': true,
        'allow_google_signals': false,
        'allow_ad_personalization_signals': false,
        'cookie_flags': 'SameSite=None;Secure',
        'page_title': document.title,
        'send_page_view': true
      });

      // Track custom events for tool usage
      window.trackToolUsage = function(toolName, action, value) {
        gtag('event', action, {
          'event_category': 'Tool Usage',
          'event_label': toolName,
          'value': value,
          'non_interaction': false
        });
      };

      // Track file conversions
      window.trackConversion = function(toolName, fileSize, duration) {
        gtag('event', 'conversion', {
          'event_category': 'PDF Conversion',
          'event_label': toolName,
          'value': Math.round(duration),
          'file_size': fileSize
        });
      };

      // Track errors
      window.trackError = function(toolName, errorMessage) {
        gtag('event', 'exception', {
          'description': `${toolName}: ${errorMessage}`,
          'fatal': false
        });
      };
    </script>
  </>
)}

<!-- 
Usage Examples:
trackToolUsage('Merge PDF', 'upload', 1);
trackConversion('Compress PDF', 5242880, 2.5);
trackError('Split PDF', 'File too large');
-->












